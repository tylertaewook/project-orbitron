(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     59034,       1432]
NotebookOptionsPosition[     56441,       1379]
NotebookOutlinePosition[     56823,       1396]
CellTagsIndexPosition[     56780,       1393]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Master 4WD/4WS vehicle control algorithm: Variables.nb", "Title",
 CellChangeTimes->{{3.759209968276164*^9, 3.75920998721935*^9}, {
  3.759210067947523*^9, 3.7592100682754445`*^9}, {3.761238756885541*^9, 
  3.761238764499885*^9}},ExpressionUUID->"7c9512d1-d4da-48ef-8c98-\
e1e558668319"],

Cell["\<\
This file contains 2D representation of vehicle control with SpaceMouse.  In \
this construction, all dimensions will be parameterized, that is, everything \
will be done with with variables so that they can be changed any time.\
\>", "Subsubsection",
 CellChangeTimes->{{3.7592099897569494`*^9, 3.7592099908754454`*^9}, {
   3.759210053738896*^9, 3.759210146138772*^9}, 
   3.7605344540085263`*^9},ExpressionUUID->"c5f43dab-9ff9-46fe-94b3-\
424a9b387d4a"],

Cell[CellGroupData[{

Cell["phy prefix is for physical dimensions", "Subsubsection",
 CellChangeTimes->{{3.7592101682754555`*^9, 
  3.759210176739315*^9}},ExpressionUUID->"7d92b0c1-39d7-4efa-b9b8-\
1a3a648261d3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"phyCarHalfWidth", "=", "1"}], ";", " ", 
   RowBox[{"phyCarHalfLength", "=", "2"}], ";", " ", 
   RowBox[{"phyGapBetweenCarAndWheel", "=", "0.8"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phyWheelX", "=", 
   RowBox[{"phyCarHalfWidth", "+", "phyGapBetweenCarAndWheel"}]}], ";", " ", 
  RowBox[{"phyWheely", "=", 
   RowBox[{"0.8", " ", "phyCarHalfLength"}]}], ";", 
  RowBox[{"phyWheelHalfThickness", "=", "0.2"}], ";", 
  RowBox[{"phyWheelRadius", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phyDrivingFieldX", "=", 
   RowBox[{"phyDrivingFieldY", "=", "10"}]}], ";", 
  RowBox[{"phyDrivingFieldGridLineGap", "=", "1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phyWheelFrontRight", "=", 
   RowBox[{"{", 
    RowBox[{"phyWheelX", ",", "phyWheely"}], "}"}]}], ";", " ", 
  RowBox[{"phyWheelBackRight", "=", 
   RowBox[{"{", 
    RowBox[{"phyWheelX", ",", 
     RowBox[{"-", "phyWheely"}]}], "}"}]}], ";", " ", 
  RowBox[{"phyWheelFrontLeft", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "phyWheelX"}], ",", 
     RowBox[{"+", "phyWheely"}]}], "}"}]}], ";", " ", 
  RowBox[{"phyWheelBackLeft", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "phyWheelX"}], ",", 
     RowBox[{"-", "phyWheely"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7592101638883038`*^9, 3.759210314035184*^9}, {
   3.759210493363475*^9, 3.7592105455150433`*^9}, {3.7592109893081136`*^9, 
   3.7592109903075204`*^9}, {3.7592110274111347`*^9, 3.759211045443742*^9}, {
   3.7592299528679643`*^9, 3.759229953187098*^9}, {3.7592303346996365`*^9, 
   3.75923038852314*^9}, {3.7592304460437*^9, 3.7592305032441316`*^9}, {
   3.7592306446758423`*^9, 3.7592306466668615`*^9}, 3.7592438757478*^9, {
   3.75928914226292*^9, 3.7592891882479467`*^9}, 3.75932084472237*^9, 
   3.759397701690525*^9},
 CellLabel->
  "In[265]:=",ExpressionUUID->"cc37747a-5654-4df7-81a7-af9a51ecb48c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Current moving directions relative to its vehicle\[CloseCurlyQuote]s \
coordinate system, i.e., from the driver\[CloseCurlyQuote]s point of view.  \
Directions are specified with unit vectors.\
\>", "Subsubsection",
 CellChangeTimes->{{3.7593980930831275`*^9, 3.759398104377429*^9}, {
  3.759398153002695*^9, 3.759398154377879*^9}, {3.7593982328980527`*^9, 
  3.759398235014021*^9}, {3.7594015958716097`*^9, 
  3.7594016220001073`*^9}},ExpressionUUID->"5c6f0d37-d563-4274-a3f3-\
95c1b0e0cb4a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dirBody", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7593981056979265`*^9, 3.759398132622839*^9}, {
  3.7593984643584137`*^9, 3.759398472363557*^9}},
 CellLabel->
  "In[269]:=",ExpressionUUID->"ff278916-81ad-471b-871f-246d15c8572c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["These are variable for the current positions", "Subsubsection",
 CellChangeTimes->{{3.7593975541456785`*^9, 
  3.75939756522231*^9}},ExpressionUUID->"bdeb9518-088d-4669-b0c1-\
42a43a04497b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"posCurveCenter", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1000"}], ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"posBody", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"posWheelFrontRight", ":=", 
   RowBox[{
    RowBox[{"RotationTransform", "[", 
     RowBox[{"rotBody", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "[", "phyWheelFrontRight", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"posWheelBackRight", ":=", 
   RowBox[{
    RowBox[{"RotationTransform", "[", 
     RowBox[{"rotBody", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "[", "phyWheelBackRight", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"posWheelFrontLeft", ":=", 
   RowBox[{
    RowBox[{"RotationTransform", "[", 
     RowBox[{"rotBody", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "[", "phyWheelFrontLeft", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"posWheelBackLeft", ":=", 
   RowBox[{
    RowBox[{"RotationTransform", "[", 
     RowBox[{"rotBody", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "[", "phyWheelBackLeft", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.759397566959583*^9, 3.759397696395726*^9}, {
   3.759398507086711*^9, 3.759398561826647*^9}, {3.7593988285323095`*^9, 
   3.7593988533168554`*^9}, {3.7593989135887585`*^9, 3.759398928642613*^9}, {
   3.7594043712405396`*^9, 3.759404375287078*^9}, 3.760241350881847*^9},
 CellLabel->
  "In[270]:=",ExpressionUUID->"6ff66e00-9805-4b6c-8710-438ba81571cb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Rotations.  Global angle in the frame of reference of the background grid.  \
This is not needed in actual driving but is needed to show the motion \
correctly.  Rotations are specified with angles in radian\
\>", "Subsubsection",
 CellChangeTimes->{{3.759398162538215*^9, 3.759398172593941*^9}, {
  3.759398217607063*^9, 3.759398222126919*^9}, {3.7594016322568865`*^9, 
  3.7594016844309034`*^9}},ExpressionUUID->"7324db92-94fa-47e5-ac34-\
ed1fe53bca4d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rotBody", "=", "0"}], ";"}]], "Input",
 CellChangeTimes->{{3.7593981769488554`*^9, 3.7593981843049655`*^9}, {
   3.7593982240447598`*^9, 3.759398226106069*^9}, {3.759398467799783*^9, 
   3.759398469372118*^9}, 3.759398796597595*^9},
 CellLabel->
  "In[276]:=",ExpressionUUID->"d5c893d6-f172-4cf8-93c7-f8f192600e00"]
}, Open  ]],

Cell[CellGroupData[{

Cell["col prefix is for colors", "Subsubsection",
 CellChangeTimes->{{3.7592103880833116`*^9, 
  3.7592103934347305`*^9}},ExpressionUUID->"8cf1ffbc-ed33-41f0-8d18-\
fc82f0eae59a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"colCarBody", "=", "White"}], ";", " ", 
  RowBox[{"colCarEdge", "=", "Gray"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"colWheelBody", "=", "White"}], ";", " ", 
   RowBox[{"colWheelEdge", "=", "Black"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"colVelocityArrow", "=", "Red"}], ";", " ", 
  RowBox[{"colCurve", "=", "Green"}], ";", "  ", 
  RowBox[{"colGridLines", "=", "LightGray"}], ";"}]}], "Input",
 CellChangeTimes->{{3.759210395214952*^9, 3.759210475243043*^9}, {
  3.759210723060201*^9, 3.759210754523487*^9}, {3.7592891999150505`*^9, 
  3.7592892179127316`*^9}, {3.7593977253546233`*^9, 3.759397751804223*^9}},
 CellLabel->
  "In[277]:=",ExpressionUUID->"1700c543-6b5e-4c87-ac53-9ac6b638b0ec"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
parameters  These are each wheel\[CloseCurlyQuote]s angle relative to the \
main body, and each wheel\[CloseCurlyQuote]s speed to be sent to the motors.\
\>", "Subsubsection",
 CellChangeTimes->{{3.760306281723737*^9, 
  3.7603063387755175`*^9}},ExpressionUUID->"46625db9-c2ea-418a-9215-\
a9585f63c1aa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"angleFrontRight", "=", "0"}], ";", " ", 
  RowBox[{"angleBackRight", "=", "0"}], ";", " ", 
  RowBox[{"angleFrontLeft", "=", "0"}], ";", " ", 
  RowBox[{"angleBackLeft", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"speedFrontRight", "=", "0"}], ";", " ", 
  RowBox[{"speedBackRight", "=", "0"}], ";", " ", 
  RowBox[{"speedFrontLeft", "=", "0"}], ";", " ", 
  RowBox[{"speedBackLeft", "=", "0"}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7603066743602824`*^9, 3.7603067982569985`*^9}},
 CellLabel->
  "In[431]:=",ExpressionUUID->"860b009e-c718-44c8-ae98-522418d7a392"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
combined commands
pos is Position\
\>", "Subsubsection",
 CellChangeTimes->{{3.759210802258671*^9, 3.7592108096274796`*^9}, {
  3.759230721388445*^9, 
  3.7592307245789905`*^9}},ExpressionUUID->"e40af1a9-53fd-44ba-ac67-\
95f0094214cd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"comBackground", "=", "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"GridLines", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{"i", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"-", "phyDrivingFieldX"}], ",", "phyDrivingFieldX", ",", 
            "phyDrivingFieldGridLineGap"}], "}"}]}], "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{"i", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"-", "phyDrivingFieldY"}], ",", "phyDrivingFieldY", ",", 
            "phyDrivingFieldGridLineGap"}], "}"}]}], "]"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"GridLinesStyle", "\[Rule]", 
      RowBox[{"Directive", "[", "colGridLines", "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"phyDrivingFieldX", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ",", 
        RowBox[{"phyDrivingFieldY", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ImageSize", "\[Rule]", "800"}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Clear", "[", "comCar", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"comCar", "[", 
    RowBox[{"posBody_", ",", "dirBodyAngle_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"EdgeForm", "[", "colCarEdge", "]"}], ",", "colCarBody", ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Rotate", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Rectangle", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"{", 
               RowBox[{"phyCarHalfWidth", ",", "phyCarHalfLength"}], "}"}]}], 
             "+", "posBody"}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"phyCarHalfWidth", ",", "phyCarHalfLength"}], "}"}], 
             "+", "posBody"}]}], "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Polygon", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "+", "posBody"}], "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "phyCarHalfWidth"}], ",", 
               RowBox[{"-", "phyCarHalfLength"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "phyCarHalfWidth"}], ",", "phyCarHalfLength"}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"1.4", "phyCarHalfLength"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"phyCarHalfWidth", ",", "phyCarHalfLength"}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"phyCarHalfWidth", ",", 
               RowBox[{"-", "phyCarHalfLength"}]}], "}"}]}], "}"}]}], "]"}], 
         ",", "\[IndentingNewLine]", "rotBody", ",", "posBody"}], "]"}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7592108111422243`*^9, 3.7592108615389595`*^9}, {
   3.7592110608020473`*^9, 3.75921112745994*^9}, {3.7592112224998903`*^9, 
   3.759211282275998*^9}, {3.7592116403499403`*^9, 3.7592116481159716`*^9}, 
   3.7592116819402275`*^9, {3.759211812179674*^9, 3.759211812456832*^9}, {
   3.7592297181165137`*^9, 3.75922978608125*^9}, {3.7592394747582846`*^9, 
   3.7592394761334977`*^9}, {3.759240460902114*^9, 3.759240461303539*^9}, 
   3.759241210239285*^9, 3.7593834184354486`*^9, {3.7593867617035265`*^9, 
   3.759386779820041*^9}, {3.7594039326476436`*^9, 3.7594039759039526`*^9}, {
   3.7594058135877476`*^9, 3.7594059598833437`*^9}, {3.759405990634948*^9, 
   3.7594060179727077`*^9}},
 CellLabel->
  "In[280]:=",ExpressionUUID->"0d7a10f3-11a6-47fc-9991-1ffbf9aac875"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "comWheels", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"comWheels", "[", 
   RowBox[{"posBody_", ",", "dirBodyAngle_", ",", "posCurveCenter_"}], "]"}], 
  ":=", "\[IndentingNewLine]", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dirFrontRight", "=", 
      RowBox[{
       RowBox[{"ArcTan", "@@", 
        RowBox[{"(", 
         RowBox[{"posCurveCenter", "-", "posWheelFrontRight"}], ")"}]}], " ", 
       "+", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"z2", ">", "0"}], ",", "Pi", ",", "0"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dirBackRight", "=", 
      RowBox[{
       RowBox[{"ArcTan", "@@", 
        RowBox[{"(", 
         RowBox[{"posCurveCenter", "-", "posWheelBackRight"}], ")"}]}], " ", 
       "+", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"z2", ">", "0"}], ",", "Pi", ",", "0"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dirFrontLeft", "=", 
      RowBox[{
       RowBox[{"ArcTan", "@@", 
        RowBox[{"(", 
         RowBox[{"posCurveCenter", "-", "posWheelFrontLeft"}], ")"}]}], " ", 
       "+", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"z2", ">", "0"}], ",", "Pi", ",", "0"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dirBackLeft", "=", 
      RowBox[{
       RowBox[{"ArcTan", "@@", 
        RowBox[{"(", 
         RowBox[{"posCurveCenter", "-", "posWheelBackLeft"}], ")"}]}], " ", 
       "+", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"z2", ">", "0"}], ",", "Pi", ",", "0"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"common", " ", "to", " ", "all", " ", "wheels"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"EdgeForm", "[", "colWheelEdge", "]"}]}], ",", "colWheelBody", 
    ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"front", " ", "right"}], "*)"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"EdgeForm", "[", "Red", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Rotate", "[", 
     RowBox[{
      RowBox[{"Rectangle", "[", 
       RowBox[{
        RowBox[{"posWheelFrontRight", "+", 
         RowBox[{"{", 
          RowBox[{"phyWheelHalfThickness", ",", 
           RowBox[{"-", "phyWheelRadius"}]}], "}"}], "+", "posBody"}], ",", 
        RowBox[{"posWheelFrontRight", "+", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "phyWheelHalfThickness"}], ",", "phyWheelRadius"}], 
          "}"}], "+", "posBody"}]}], "]"}], ",", "dirFrontRight", ",", 
      RowBox[{"posWheelFrontRight", "+", "posBody"}]}], "]"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"back", " ", "right"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"EdgeForm", "[", "Blue", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Rotate", "[", 
     RowBox[{
      RowBox[{"Rectangle", "[", 
       RowBox[{
        RowBox[{"posWheelBackRight", "+", 
         RowBox[{"{", 
          RowBox[{"phyWheelHalfThickness", ",", 
           RowBox[{"-", "phyWheelRadius"}]}], "}"}], "+", "posBody"}], ",", 
        RowBox[{"posWheelBackRight", "+", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "phyWheelHalfThickness"}], ",", "phyWheelRadius"}], 
          "}"}], "+", "posBody"}]}], "]"}], ",", "dirBackRight", ",", 
      RowBox[{"posWheelBackRight", "+", "posBody"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"front", " ", "left"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"EdgeForm", "[", "Purple", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Rotate", "[", 
     RowBox[{
      RowBox[{"Rectangle", "[", 
       RowBox[{
        RowBox[{"posWheelFrontLeft", "+", 
         RowBox[{"{", 
          RowBox[{"phyWheelHalfThickness", ",", 
           RowBox[{"-", "phyWheelRadius"}]}], "}"}], "+", "posBody"}], ",", 
        RowBox[{"posWheelFrontLeft", "+", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "phyWheelHalfThickness"}], ",", "phyWheelRadius"}], 
          "}"}], "+", "posBody"}]}], "]"}], ",", "dirFrontLeft", ",", 
      RowBox[{"posWheelFrontLeft", "+", "posBody"}]}], "]"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"back", " ", "left"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"EdgeForm", "[", 
     RowBox[{"Darker", "[", "Green", "]"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Rotate", "[", 
     RowBox[{
      RowBox[{"Rectangle", "[", 
       RowBox[{
        RowBox[{"posWheelBackLeft", "+", 
         RowBox[{"{", 
          RowBox[{"phyWheelHalfThickness", ",", 
           RowBox[{"-", "phyWheelRadius"}]}], "}"}], "+", "posBody"}], ",", 
        RowBox[{"posWheelBackLeft", "+", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "phyWheelHalfThickness"}], ",", "phyWheelRadius"}], 
          "}"}], "+", "posBody"}]}], "]"}], ",", "dirBackLeft", ",", 
      RowBox[{"posWheelBackLeft", "+", "posBody"}]}], "]"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"PointSize", "\[Rule]", "Large"}], ",", "Red", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Point", "[", 
     RowBox[{"posWheelFrontRight", "+", "posBody"}], "]"}], ",", 
    RowBox[{"Point", "[", 
     RowBox[{"posWheelBackRight", "+", "posBody"}], "]"}], ",", 
    RowBox[{"Point", "[", 
     RowBox[{"posWheelFrontLeft", "+", "posBody"}], "]"}], ",", 
    RowBox[{"Point", "[", 
     RowBox[{"posWheelBackLeft", "+", "posBody"}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}]}]}], "Input",
 CellChangeTimes->{{3.7592108111422243`*^9, 3.7592108615389595`*^9}, {
   3.7592110608020473`*^9, 3.75921112745994*^9}, {3.7592112224998903`*^9, 
   3.759211282275998*^9}, {3.7592116403499403`*^9, 3.7592116481159716`*^9}, 
   3.7592116819402275`*^9, {3.759211822885392*^9, 3.759211839665762*^9}, {
   3.7592298558515863`*^9, 3.7592300100605607`*^9}, {3.7592302049004216`*^9, 
   3.7592302751724215`*^9}, {3.7592304021471233`*^9, 3.759230423691347*^9}, {
   3.7592305265002594`*^9, 3.759230630054366*^9}, {3.759239464493453*^9, 
   3.759239469074637*^9}, {3.759240451581975*^9, 3.7592404521626673`*^9}, {
   3.759240715605007*^9, 3.759240809121516*^9}, {3.759243319177978*^9, 
   3.7592433206478305`*^9}, {3.75924341254902*^9, 3.7592434588963614`*^9}, {
   3.7592435015208654`*^9, 3.759243541048825*^9}, {3.759243577637144*^9, 
   3.759243638013183*^9}, {3.7592436713372297`*^9, 3.7592436843266673`*^9}, {
   3.759243823575898*^9, 3.7592438336213923`*^9}, {3.7592445557745275`*^9, 
   3.75924457508939*^9}, {3.759244620464672*^9, 3.759244729251376*^9}, {
   3.759244781177453*^9, 3.759244789202799*^9}, {3.7592448256613607`*^9, 
   3.759244842519393*^9}, {3.7592448878672113`*^9, 3.7592448926839085`*^9}, {
   3.759244983836142*^9, 3.759244986700701*^9}, {3.759245046480318*^9, 
   3.759245052804797*^9}, {3.759296339663742*^9, 3.7592963825610375`*^9}, {
   3.759321151701084*^9, 3.75932115243604*^9}, {3.7593797484705048`*^9, 
   3.7593797862641277`*^9}, 3.7593798984519033`*^9, {3.759379954141458*^9, 
   3.759379986119151*^9}, {3.7593800750044518`*^9, 3.759380076333763*^9}, {
   3.759380164220611*^9, 3.759380213133794*^9}, 3.7593803597130327`*^9, 
   3.7593833626033688`*^9, {3.759398665867276*^9, 3.759398674424839*^9}, {
   3.759398721433878*^9, 3.759398754986807*^9}, {3.759402174001198*^9, 
   3.759402188404009*^9}, {3.7594022421240516`*^9, 3.7594022553244452`*^9}, {
   3.759403670006652*^9, 3.759403683993679*^9}, 3.7594040559779234`*^9, {
   3.7594042450232663`*^9, 3.7594042624663157`*^9}, {3.7594044011042137`*^9, 
   3.759404442268013*^9}, {3.7594053891646423`*^9, 3.759405434456462*^9}, {
   3.7594054657343493`*^9, 3.7594055179142256`*^9}, {3.7594055608514085`*^9, 
   3.759405566824539*^9}, {3.759405667348604*^9, 3.7594056715698347`*^9}, {
   3.7602691734324956`*^9, 3.760269175862756*^9}, {3.7602692331801443`*^9, 
   3.7602692653188004`*^9}, {3.7602694319723473`*^9, 
   3.7602694760806065`*^9}, {3.7602695142255*^9, 3.7602695165864677`*^9}},
 CellLabel->
  "In[315]:=",ExpressionUUID->"e386794b-c999-4913-a56c-28737d515a48"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "comDrawCircles", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"comDrawCircles", "[", 
   RowBox[{"posBody_", ",", "dirBodyAngle_", ",", "posCurveCenter_"}], "]"}], 
  ":=", "\[IndentingNewLine]", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Circle", " ", "that", " ", "passes", " ", "through", " ", "the", " ", 
     "center", " ", "of", " ", "the", " ", "vehicle"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"colCurve", ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"PointSize", "\[Rule]", "0.05"}], ",", 
      RowBox[{"Point", "[", 
       RowBox[{"posCurveCenter", "+", "posBody"}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"bodyRadius", "=", 
      RowBox[{"Norm", "[", "posCurveCenter", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"wheelFrontRightRadius", "=", 
      RowBox[{"Norm", "[", 
       RowBox[{"posCurveCenter", "-", "posWheelFrontRight"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"wheelBackRightRadius", "=", 
      RowBox[{"Norm", "[", 
       RowBox[{"posCurveCenter", "-", "posWheelBackRight"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"wheelFrontLeftRadius", "=", 
      RowBox[{"Norm", "[", 
       RowBox[{"posCurveCenter", "-", "posWheelFrontLeft"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"wheelBackLeftRadius", "=", 
      RowBox[{"Norm", "[", 
       RowBox[{"posCurveCenter", "-", "posWheelBackLeft"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Circle", "[", 
      RowBox[{
       RowBox[{"posCurveCenter", "+", "posBody"}], ",", "bodyRadius"}], 
      "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"front", " ", "right", " ", 
      RowBox[{"wheel", "'"}], "s", " ", "path", " ", "circle"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Circle", "[", 
     RowBox[{
      RowBox[{"posCurveCenter", "+", "posBody"}], ",", 
      "wheelFrontRightRadius"}], "]"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"back", " ", "right", " ", 
      RowBox[{"wheel", "'"}], "s", " ", "path", " ", "circle"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Circle", "[", 
     RowBox[{
      RowBox[{"posCurveCenter", "+", "posBody"}], ",", 
      "wheelBackRightRadius"}], "]"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"front", " ", "left", " ", 
      RowBox[{"wheel", "'"}], "s", " ", "path", " ", "circle"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Circle", "[", 
     RowBox[{
      RowBox[{"posCurveCenter", "+", "posBody"}], ",", 
      "wheelFrontLeftRadius"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"back", " ", "left", " ", 
      RowBox[{"wheel", "'"}], "s", " ", "path", " ", "circle"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Circle", "[", 
     RowBox[{
      RowBox[{"posCurveCenter", "+", "posBody"}], ",", 
      "wheelBackLeftRadius"}], "]"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"arcLength", "=", "2"}], ";", "\[IndentingNewLine]", 
     RowBox[{"arrowLength", "=", "0.1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Arrowheads", "[", "0.02", "]"}]}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "Blue", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"bodyRadius", "=", 
      RowBox[{"Norm", "[", "posCurveCenter", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"angle", "=", 
      RowBox[{"ArcTan", "@@", 
       RowBox[{"(", "posCurveCenter", ")"}]}]}], " ", ";", 
     "\[IndentingNewLine]", 
     RowBox[{"angleEnd", "=", 
      RowBox[{"angle", "+", 
       RowBox[{"arcLength", "  ", 
        RowBox[{
         RowBox[{"Sign", "[", "z2", "]"}], " ", "/", "radius"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"direction", "=", 
      RowBox[{
       RowBox[{"-", "arrowLength"}], " ", 
       RowBox[{"Sign", "[", "z2", "]"}], 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Sin", "[", "angleEnd", "]"}]}], ",", 
         RowBox[{"Cos", "[", "angleEnd", "]"}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Circle", "[", 
      RowBox[{
       RowBox[{"posCurveCenter", "+", "posBody"}], ",", "bodyRadius", ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"angle", ",", "angleEnd"}], "}"}], "+", "Pi"}]}], "]"}]}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"arcTip", "=", 
      RowBox[{"posCurveCenter", "+", 
       RowBox[{"bodyRadius", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"angleEnd", "+", "Pi"}], "]"}], ",", 
          RowBox[{"Sin", "[", 
           RowBox[{"angleEnd", "+", "Pi"}], "]"}]}], "}"}]}], "+", 
       "posBody"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Arrow", "[", 
      RowBox[{"{", 
       RowBox[{"arcTip", ",", 
        RowBox[{"arcTip", "+", "direction"}]}], "}"}], "]"}]}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"front", " ", "right", " ", "wheel", " ", "direction"}], "*)"}], 
    "\[IndentingNewLine]", "Red", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"b1", "||", "b2"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{"b1", ",", 
         RowBox[{"reductionFactor", "=", "2000"}], ",", 
         RowBox[{"reductionFactor", "=", "2000"}]}], "]"}], ",", 
       RowBox[{"reductionFactor", "=", "1"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"posFrontRightWheelCenter", "=", 
      RowBox[{"(", 
       RowBox[{"posWheelFrontRight", "+", "posBody"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"radius", "=", 
      RowBox[{"Norm", "[", 
       RowBox[{"posCurveCenter", "-", "posWheelFrontRight"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"angle", "=", 
      RowBox[{"ArcTan", "@@", 
       RowBox[{"(", 
        RowBox[{"posCurveCenter", "-", "posWheelFrontRight"}], ")"}]}]}], " ",
      ";", "\[IndentingNewLine]", 
     RowBox[{"angleEnd", "=", 
      RowBox[{"angle", "+", 
       RowBox[{
        RowBox[{"arcLength", "/", "reductionFactor"}], " ", 
        RowBox[{
         RowBox[{"Sign", "[", "z2", "]"}], " ", "/", "bodyRadius"}]}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"direction", "=", 
      RowBox[{
       RowBox[{"-", "arrowLength"}], " ", 
       RowBox[{"Sign", "[", "z2", "]"}], 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Sin", "[", "angleEnd", "]"}]}], ",", 
         RowBox[{"Cos", "[", "angleEnd", "]"}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Circle", "[", 
      RowBox[{
       RowBox[{"posCurveCenter", "+", "posBody"}], ",", "radius", ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"angle", ",", "angleEnd"}], "}"}], "+", "Pi"}]}], "]"}]}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"arcTip", "=", 
      RowBox[{"posCurveCenter", "+", 
       RowBox[{"radius", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"angleEnd", "+", "Pi"}], "]"}], ",", 
          RowBox[{"Sin", "[", 
           RowBox[{"angleEnd", "+", "Pi"}], "]"}]}], "}"}]}], "+", 
       "posBody"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Arrow", "[", 
      RowBox[{"{", 
       RowBox[{"arcTip", ",", 
        RowBox[{"arcTip", "+", "direction"}]}], "}"}], "]"}]}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"back", " ", "right", " ", "wheel", " ", "direction"}], "*)"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"posBackRightWheelCenter", "=", 
      RowBox[{"(", 
       RowBox[{"posWheelBackRight", "+", "posBody"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"radius", "=", 
      RowBox[{"Norm", "[", 
       RowBox[{"posCurveCenter", "-", "posWheelBackRight"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"angle", "=", 
      RowBox[{"ArcTan", "@@", 
       RowBox[{"(", 
        RowBox[{"posCurveCenter", "-", "posWheelBackRight"}], ")"}]}]}], " ", 
     ";", "\[IndentingNewLine]", 
     RowBox[{"angleEnd", "=", 
      RowBox[{"angle", "+", 
       RowBox[{
        RowBox[{"arcLength", "/", "reductionFactor"}], " ", 
        RowBox[{
         RowBox[{"Sign", "[", "z2", "]"}], " ", "/", "bodyRadius"}]}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"direction", "=", 
      RowBox[{
       RowBox[{"-", "arrowLength"}], " ", 
       RowBox[{"Sign", "[", "z2", "]"}], 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Sin", "[", "angleEnd", "]"}]}], ",", 
         RowBox[{"Cos", "[", "angleEnd", "]"}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Circle", "[", 
      RowBox[{
       RowBox[{"posCurveCenter", "+", "posBody"}], ",", "radius", ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"angle", ",", "angleEnd"}], "}"}], "+", "Pi"}]}], "]"}]}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"arcTip", "=", 
      RowBox[{"posCurveCenter", "+", 
       RowBox[{"radius", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"angleEnd", "+", "Pi"}], "]"}], ",", 
          RowBox[{"Sin", "[", 
           RowBox[{"angleEnd", "+", "Pi"}], "]"}]}], "}"}]}], "+", 
       "posBody"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Arrow", "[", 
      RowBox[{"{", 
       RowBox[{"arcTip", ",", 
        RowBox[{"arcTip", "+", "direction"}]}], "}"}], "]"}]}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"front", " ", "left", " ", "wheel", " ", "direction"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"posFrontLeftWheelCenter", "=", 
      RowBox[{"(", 
       RowBox[{"posWheelFrontLeft", "+", "posBody"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"radius", "=", 
      RowBox[{"Norm", "[", 
       RowBox[{"posCurveCenter", "-", "posWheelFrontLeft"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"angle", "=", 
      RowBox[{"ArcTan", "@@", 
       RowBox[{"(", 
        RowBox[{"posCurveCenter", "-", "posWheelFrontLeft"}], ")"}]}]}], " ", 
     ";", "\[IndentingNewLine]", 
     RowBox[{"angleEnd", "=", 
      RowBox[{"angle", "+", 
       RowBox[{
        RowBox[{"arcLength", "/", "reductionFactor"}], " ", 
        RowBox[{
         RowBox[{"Sign", "[", "z2", "]"}], " ", "/", "bodyRadius"}]}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"direction", "=", 
      RowBox[{
       RowBox[{"-", "arrowLength"}], " ", 
       RowBox[{"Sign", "[", "z2", "]"}], 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Sin", "[", "angleEnd", "]"}]}], ",", 
         RowBox[{"Cos", "[", "angleEnd", "]"}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Circle", "[", 
      RowBox[{
       RowBox[{"posCurveCenter", "+", "posBody"}], ",", "radius", ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"angle", ",", "angleEnd"}], "}"}], "+", "Pi"}]}], "]"}]}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"arcTip", "=", 
      RowBox[{"posCurveCenter", "+", 
       RowBox[{"radius", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"angleEnd", "+", "Pi"}], "]"}], ",", 
          RowBox[{"Sin", "[", 
           RowBox[{"angleEnd", "+", "Pi"}], "]"}]}], "}"}]}], "+", 
       "posBody"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Arrow", "[", 
      RowBox[{"{", 
       RowBox[{"arcTip", ",", 
        RowBox[{"arcTip", "+", "direction"}]}], "}"}], "]"}]}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"back", " ", "left", " ", "wheel", " ", "direction"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"posBackLeftWheelCenter", "=", 
      RowBox[{"(", 
       RowBox[{"posWheelBackLeft", "+", "posBody"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"radius", "=", 
      RowBox[{"Norm", "[", 
       RowBox[{"posCurveCenter", "-", "posWheelBackLeft"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"angle", "=", 
      RowBox[{"ArcTan", "@@", 
       RowBox[{"(", 
        RowBox[{"posCurveCenter", "-", "posWheelBackLeft"}], ")"}]}]}], " ", 
     ";", "\[IndentingNewLine]", 
     RowBox[{"angleEnd", "=", 
      RowBox[{"angle", "+", 
       RowBox[{
        RowBox[{"arcLength", "/", "reductionFactor"}], " ", 
        RowBox[{
         RowBox[{"Sign", "[", "z2", "]"}], " ", "/", "bodyRadius"}]}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"direction", "=", 
      RowBox[{
       RowBox[{"-", "arrowLength"}], " ", 
       RowBox[{"Sign", "[", "z2", "]"}], 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Sin", "[", "angleEnd", "]"}]}], ",", 
         RowBox[{"Cos", "[", "angleEnd", "]"}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Circle", "[", 
      RowBox[{
       RowBox[{"posCurveCenter", "+", "posBody"}], ",", "radius", ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"angle", ",", "angleEnd"}], "}"}], "+", "Pi"}]}], "]"}]}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"arcTip", "=", 
      RowBox[{"posCurveCenter", "+", 
       RowBox[{"radius", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"angleEnd", "+", "Pi"}], "]"}], ",", 
          RowBox[{"Sin", "[", 
           RowBox[{"angleEnd", "+", "Pi"}], "]"}]}], "}"}]}], "+", 
       "posBody"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Arrow", "[", 
      RowBox[{"{", 
       RowBox[{"arcTip", ",", 
        RowBox[{"arcTip", "+", "direction"}]}], "}"}], "]"}]}]}], 
   "\[IndentingNewLine]", "}"}]}]}], "Input",
 CellChangeTimes->{{3.7592445392015586`*^9, 3.759244578270376*^9}, {
   3.7593211302027245`*^9, 3.7593213083867908`*^9}, {3.759322243995034*^9, 
   3.7593223010305643`*^9}, {3.759322331844874*^9, 3.7593223426726646`*^9}, {
   3.7593223809006553`*^9, 3.759322417734929*^9}, 3.759322516358903*^9, {
   3.7593226328983235`*^9, 3.7593226769237843`*^9}, {3.759323861606947*^9, 
   3.7593239114698706`*^9}, {3.7593771096655364`*^9, 3.75937715649653*^9}, {
   3.7593773231783147`*^9, 3.7593773250102935`*^9}, {3.759377475399743*^9, 
   3.7593775550716295`*^9}, {3.759377657994269*^9, 3.7593776828325186`*^9}, {
   3.759377731555416*^9, 3.759377774606816*^9}, {3.7593778325597143`*^9, 
   3.759377858373968*^9}, {3.7593778943941946`*^9, 3.759377903250451*^9}, {
   3.759377951880624*^9, 3.7593779566200495`*^9}, {3.7593780145466566`*^9, 
   3.759378034117378*^9}, {3.759378095859169*^9, 3.759378103222083*^9}, {
   3.759378213723853*^9, 3.759378307306637*^9}, {3.7593783376192303`*^9, 
   3.7593783795497046`*^9}, {3.7593784179923763`*^9, 
   3.7593785476462107`*^9}, {3.75937857851221*^9, 3.7593785849934025`*^9}, {
   3.7593786324426203`*^9, 3.7593786712307916`*^9}, {3.7593787154894886`*^9, 
   3.7593787237269325`*^9}, {3.759378759421731*^9, 3.7593787773420887`*^9}, {
   3.7593788203778405`*^9, 3.759378851017412*^9}, {3.7593789107358913`*^9, 
   3.7593789333658953`*^9}, {3.759378974180237*^9, 3.759379000012059*^9}, 
   3.7593795385581303`*^9, {3.759379569898527*^9, 3.759379651515641*^9}, {
   3.759380255622034*^9, 3.7593802706563363`*^9}, {3.75938059871154*^9, 
   3.759380678704503*^9}, {3.759380778071064*^9, 3.7593808273658967`*^9}, {
   3.759380917799187*^9, 3.7593809335098295`*^9}, {3.7593809861328473`*^9, 
   3.7593810608066072`*^9}, {3.759381101805439*^9, 3.7593811159281683`*^9}, {
   3.7593833659266195`*^9, 3.7593833713697968`*^9}, {3.759383542213721*^9, 
   3.7593835689278126`*^9}, 3.759397765525807*^9, {3.759401969748777*^9, 
   3.7594020803510685`*^9}, {3.7594082355199423`*^9, 3.7594083262196455`*^9}, 
   3.7599729626909695`*^9, 3.7602675473774304`*^9, {3.760267580889305*^9, 
   3.7602675849231105`*^9}, {3.760267713619137*^9, 3.760267715608194*^9}, 
   3.760267752800563*^9, {3.760267793202961*^9, 3.760267821579118*^9}, {
   3.7602680304562798`*^9, 3.7602680443398466`*^9}, {3.760268165440652*^9, 
   3.760268251289413*^9}, {3.7602682948198586`*^9, 3.760268311160037*^9}, 
   3.7602683970819626`*^9, {3.7602714564887877`*^9, 3.760271629408218*^9}, 
   3.760309598360382*^9, {3.760309633589332*^9, 3.760309633962228*^9}, {
   3.760309703119276*^9, 3.760309707920035*^9}, {3.7603097436028786`*^9, 
   3.7603097632383957`*^9}, {3.7603102138520107`*^9, 
   3.7603102173509283`*^9}, {3.7603103262137365`*^9, 
   3.7603103894749756`*^9}, {3.7603104242673407`*^9, 3.760310485907445*^9}, 
   3.760310539576555*^9, {3.7603106005081177`*^9, 3.7603106125402164`*^9}, 
   3.7603116987514067`*^9, {3.7603117368123903`*^9, 3.7603117482686205`*^9}},
 CellLabel->
  "In[486]:=",ExpressionUUID->"6575f0e2-e463-44b0-933f-329ce8eb2864"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "comWheelLabels", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"comWheelLabels", "[", 
   RowBox[{"posBody_", ",", "dirBodyAngle_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"common", " ", "to", " ", "all", " ", "wheels"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Arrowheads", "[", "0.02", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"front", " ", "right"}], "*)"}], "\[IndentingNewLine]", 
    "LightGray", ",", "\[IndentingNewLine]", 
    RowBox[{"Arrow", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"1.1", "phyWheelFrontRight"}], "+", "posBody"}], ",", 
       RowBox[{
        RowBox[{"1.9", "phyWheelFrontRight"}], "+", "posBody"}]}], "}"}], 
     "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"back", " ", "right"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"Arrow", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"1.1", "phyWheelBackRight"}], "+", "posBody"}], ",", 
       RowBox[{
        RowBox[{"1.9", "phyWheelBackRight"}], "+", "posBody"}]}], "}"}], 
     "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"front", " ", "left"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"Arrow", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"1.1", "phyWheelFrontLeft"}], "+", "posBody"}], ",", 
       RowBox[{
        RowBox[{"1.9", "phyWheelFrontLeft"}], "+", "posBody"}]}], "}"}], 
     "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"back", " ", "left"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"Arrow", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"1.1", "phyWheelBackLeft"}], "+", "posBody"}], ",", 
       RowBox[{
        RowBox[{"1.9", "phyWheelBackLeft"}], "+", "posBody"}]}], "}"}], "]"}],
     ",", "\[IndentingNewLine]", "\[IndentingNewLine]", "Gray", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Text", "[", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{"\"\<Stuff\>\"", ",", "18"}], "]"}], ",", 
      RowBox[{
       RowBox[{"2", "phyWheelFrontRight"}], "+", "posBody"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Text", "[", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{"\"\<Stuff\>\"", ",", "18"}], "]"}], ",", 
      RowBox[{
       RowBox[{"2", "phyWheelBackRight"}], "+", "posBody"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Text", "[", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{"\"\<Stuff\>\"", ",", "18"}], "]"}], ",", 
      RowBox[{
       RowBox[{"2", "phyWheelFrontLeft"}], "+", "posBody"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Text", "[", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{"\"\<Stuff\>\"", ",", "18"}], "]"}], ",", 
      RowBox[{
       RowBox[{"2", "phyWheelBackLeft"}], "+", "posBody"}]}], "]"}]}], 
   "\[IndentingNewLine]", "}"}]}]}], "Input",
 CellChangeTimes->{{3.7592397490688086`*^9, 3.759239842754507*^9}, {
   3.7592398780740805`*^9, 3.7592400656943493`*^9}, {3.7592404554586024`*^9, 
   3.759240455855628*^9}, 3.759383375725685*^9},
 CellLabel->
  "In[287]:=",ExpressionUUID->"52dd57fd-f896-4e61-9055-8a2590a40650"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
This will show the calculation for each wheel\[CloseCurlyQuote]s speed and \
angle relative to the main body\
\>", "Subsubsection",
 CellChangeTimes->{{3.7602685588428397`*^9, 
  3.76026857464914*^9}},ExpressionUUID->"fad85750-c3e3-40a2-8dce-\
6410f9d67c60"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "comDrawCalculations", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"comDrawCalculations", "[", 
   RowBox[{"posBody_", ",", "dirBodyAngle_", ",", "posCurveCenter_"}], "]"}], 
  ":=", "\[IndentingNewLine]", 
  RowBox[{
  "{", "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "First", " ", "draw", " ", "where", " ", "the", " ", "direction", " ", 
     "0", " ", "would", " ", "be", " ", "for", " ", "each", " ", "wheel"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Arrowheads", "[", "0.02", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"front", " ", "right", " ", "wheel"}], " ", "*)"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"angleFrontRight", "=", 
      RowBox[{"(", 
       RowBox[{"dirFrontRight", "-", "rotBody"}], ")"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"angleFrontRight", "=", 
      RowBox[{
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"angleFrontRight", "+", "Pi"}], ",", 
         RowBox[{"2", "Pi"}]}], "]"}], "-", "Pi"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"angleBackRight", "=", 
      RowBox[{"(", 
       RowBox[{"dirBackRight", "-", "rotBody"}], ")"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"angleBackRight", "=", 
      RowBox[{
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"angleBackRight", "+", "Pi"}], ",", 
         RowBox[{"2", "Pi"}]}], "]"}], "-", "Pi"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"angleFrontLeft", "=", 
      RowBox[{"(", 
       RowBox[{"dirFrontLeft", "-", "rotBody"}], ")"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"angleFrontLeft", "=", 
      RowBox[{
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"angleFrontLeft", "+", "Pi"}], ",", 
         RowBox[{"2", "Pi"}]}], "]"}], "-", "Pi"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"angleBackLeft", "=", 
      RowBox[{"(", 
       RowBox[{"dirBackLeft", "-", "rotBody"}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"angleBackLeft", "=", 
      RowBox[{
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"angleBackLeft", "+", "Pi"}], ",", 
         RowBox[{"2", "Pi"}]}], "]"}], "-", "Pi"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"speedFrontRight", "=", 
      RowBox[{"wheelFrontRightRadius", "/", "bodyRadius"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"speedBackRight", "=", 
      RowBox[{"wheelBackRightRadius", "/", "bodyRadius"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"speedFrontLeft", "=", 
      RowBox[{"wheelFrontLeftRadius", "/", "bodyRadius"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"speedBackLeft", "=", 
      RowBox[{"wheelBackLeftRadius", "/", "bodyRadius"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "Gray"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Rotate", "[", 
     RowBox[{
      RowBox[{"Arrow", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"posWheelFrontRight", "+", "posBody"}], ",", 
         RowBox[{"posWheelFrontRight", "+", "posBody", "+", 
          RowBox[{"{", 
           RowBox[{"0", ",", "arcLength"}], "}"}]}]}], "}"}], "]"}], ",", 
      "rotBody", ",", 
      RowBox[{"posWheelFrontRight", "+", "posBody"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Rotate", "[", 
     RowBox[{
      RowBox[{"Arrow", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"posWheelBackRight", "+", "posBody"}], ",", 
         RowBox[{"posWheelBackRight", "+", "posBody", "+", 
          RowBox[{"{", 
           RowBox[{"0", ",", "arcLength"}], "}"}]}]}], "}"}], "]"}], ",", 
      "rotBody", ",", 
      RowBox[{"posWheelBackRight", "+", "posBody"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Rotate", "[", 
     RowBox[{
      RowBox[{"Arrow", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"posWheelFrontLeft", "+", "posBody"}], ",", 
         RowBox[{"posWheelFrontLeft", "+", "posBody", "+", 
          RowBox[{"{", 
           RowBox[{"0", ",", "arcLength"}], "}"}]}]}], "}"}], "]"}], ",", 
      "rotBody", ",", 
      RowBox[{"posWheelFrontLeft", "+", "posBody"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Rotate", "[", 
     RowBox[{
      RowBox[{"Arrow", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"posWheelBackLeft", "+", "posBody"}], ",", 
         RowBox[{"posWheelBackLeft", "+", "posBody", "+", 
          RowBox[{"{", 
           RowBox[{"0", ",", "arcLength"}], "}"}]}]}], "}"}], "]"}], ",", 
      "rotBody", ",", 
      RowBox[{"posWheelBackLeft", "+", "posBody"}]}], "]"}], ",", 
    "\[IndentingNewLine]", "Pink", ",", "\[IndentingNewLine]", 
    RowBox[{"Rotate", "[", 
     RowBox[{
      RowBox[{"Arrow", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"posWheelFrontRight", "+", "posBody"}], ",", 
         RowBox[{"posWheelFrontRight", "+", "posBody", "+", 
          RowBox[{"{", 
           RowBox[{"0", ",", "arcLength"}], "}"}]}]}], "}"}], "]"}], ",", 
      RowBox[{"rotBody", "+", "angleFrontRight"}], ",", 
      RowBox[{"posWheelFrontRight", "+", "posBody"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Rotate", "[", 
     RowBox[{
      RowBox[{"Arrow", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"posWheelBackRight", "+", "posBody"}], ",", 
         RowBox[{"posWheelBackRight", "+", "posBody", "+", 
          RowBox[{"{", 
           RowBox[{"0", ",", "arcLength"}], "}"}]}]}], "}"}], "]"}], ",", 
      RowBox[{"rotBody", "+", "angleBackRight"}], ",", 
      RowBox[{"posWheelBackRight", "+", "posBody"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Rotate", "[", 
     RowBox[{
      RowBox[{"Arrow", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"posWheelFrontLeft", "+", "posBody"}], ",", 
         RowBox[{"posWheelFrontLeft", "+", "posBody", "+", 
          RowBox[{"{", 
           RowBox[{"0", ",", "arcLength"}], "}"}]}]}], "}"}], "]"}], ",", 
      RowBox[{"rotBody", "+", "angleFrontLeft"}], ",", 
      RowBox[{"posWheelFrontLeft", "+", "posBody"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Rotate", "[", 
     RowBox[{
      RowBox[{"Arrow", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"posWheelBackLeft", "+", "posBody"}], ",", 
         RowBox[{"posWheelBackLeft", "+", "posBody", "+", 
          RowBox[{"{", 
           RowBox[{"0", ",", "arcLength"}], "}"}]}]}], "}"}], "]"}], ",", 
      RowBox[{"rotBody", "+", "angleBackLeft"}], ",", 
      RowBox[{"posWheelBackLeft", "+", "posBody"}]}], "]"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"circleRadius", "=", "2"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Rotate", "[", 
      RowBox[{
       RowBox[{"Circle", "[", 
        RowBox[{
         RowBox[{"posWheelFrontRight", "+", "posBody"}], ",", "circleRadius", 
         ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "angleFrontRight"}], "}"}], "+", 
          RowBox[{"Pi", "/", "2"}]}]}], "]"}], ",", "rotBody", ",", 
       RowBox[{"posWheelFrontRight", "+", "posBody"}]}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Text", "[", 
     RowBox[{
      RowBox[{"\"\<Angle = \>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"-", "angleFrontRight"}], " ", 
         RowBox[{"180", "/", "Pi"}]}], "]"}], "<>", "\"\<\[Degree]\>\"", 
       "<>", "\"\<\\nSpeed = \>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{"wheelFrontRightRadius", "/", "bodyRadius"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"RotationTransform", "[", 
        RowBox[{"rotBody", ",", 
         RowBox[{"posWheelFrontRight", "+", "posBody"}]}], "]"}], "[", 
       RowBox[{"posWheelFrontRight", "+", 
        RowBox[{"3", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}], "+", "posBody"}], "]"}]}], "]"}], 
    ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Rotate", "[", 
     RowBox[{
      RowBox[{"Circle", "[", 
       RowBox[{
        RowBox[{"posWheelBackRight", "+", "posBody"}], ",", "circleRadius", 
        ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "angleBackRight"}], "}"}], "+", 
         RowBox[{"Pi", "/", "2"}]}]}], "]"}], ",", "rotBody", ",", 
      RowBox[{"posWheelBackRight", "+", "posBody"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Text", "[", 
     RowBox[{
      RowBox[{"\"\<Angle = \>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"-", "angleBackRight"}], " ", 
         RowBox[{"180", "/", "Pi"}]}], "]"}], "<>", "\"\<\[Degree]\>\"", 
       "<>", "\"\<\\nSpeed = \>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{"wheelBackRightRadius", "/", "bodyRadius"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"RotationTransform", "[", 
        RowBox[{"rotBody", ",", 
         RowBox[{"posWheelBackRight", "+", "posBody"}]}], "]"}], "[", 
       RowBox[{"posWheelBackRight", "+", 
        RowBox[{"3", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}], "+", "posBody"}], "]"}]}], "]"}], 
    ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Rotate", "[", 
     RowBox[{
      RowBox[{"Circle", "[", 
       RowBox[{
        RowBox[{"posWheelFrontLeft", "+", "posBody"}], ",", "circleRadius", 
        ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "angleFrontLeft"}], "}"}], "+", 
         RowBox[{"Pi", "/", "2"}]}]}], "]"}], ",", "rotBody", ",", 
      RowBox[{"posWheelFrontLeft", "+", "posBody"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Text", "[", 
     RowBox[{
      RowBox[{"\"\<Angle = \>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"-", "angleFrontLeft"}], " ", 
         RowBox[{"180", "/", "Pi"}]}], "]"}], "<>", "\"\<\[Degree]\>\"", 
       "<>", "\"\<\\nSpeed = \>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{"wheelFrontLeftRadius", "/", "bodyRadius"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"RotationTransform", "[", 
        RowBox[{"rotBody", ",", 
         RowBox[{"posWheelFrontLeft", "+", "posBody"}]}], "]"}], "[", 
       RowBox[{"posWheelFrontLeft", "+", 
        RowBox[{"3", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "+", "posBody"}], "]"}]}],
      "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Rotate", "[", 
     RowBox[{
      RowBox[{"Circle", "[", 
       RowBox[{
        RowBox[{"posWheelBackLeft", "+", "posBody"}], ",", "circleRadius", 
        ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "angleBackLeft"}], "}"}], "+", 
         RowBox[{"Pi", "/", "2"}]}]}], "]"}], ",", "rotBody", ",", 
      RowBox[{"posWheelBackLeft", "+", "posBody"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Text", "[", 
     RowBox[{
      RowBox[{"\"\<Angle = \>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"-", "angleBackLeft"}], " ", 
         RowBox[{"180", "/", "Pi"}]}], "]"}], "<>", "\"\<\[Degree]\>\"", 
       "<>", "\"\<\\nSpeed = \>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{"wheelBackLeftRadius", "/", "bodyRadius"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"RotationTransform", "[", 
        RowBox[{"rotBody", ",", 
         RowBox[{"posWheelBackLeft", "+", "posBody"}]}], "]"}], "[", 
       RowBox[{"posWheelBackLeft", "+", 
        RowBox[{"3", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "+", "posBody"}], "]"}]}],
      "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "}"}]}]}], "Input",
 CellChangeTimes->{{3.7602685507655125`*^9, 3.7602686179951572`*^9}, {
   3.760268652994464*^9, 3.760268727435754*^9}, {3.760268771784114*^9, 
   3.7602687965598106`*^9}, {3.76026882940018*^9, 3.760268921247416*^9}, 
   3.7602689536075697`*^9, {3.760269011583809*^9, 3.7602690302234116`*^9}, {
   3.760269068825066*^9, 3.760269072421644*^9}, {3.760269546742812*^9, 
   3.760269610028453*^9}, {3.760269692525634*^9, 3.760269700344351*^9}, {
   3.7602697976591854`*^9, 3.7602700165266294`*^9}, {3.760270088089704*^9, 
   3.7602701685051107`*^9}, {3.7602702048083096`*^9, 3.760270291741406*^9}, {
   3.760270330957987*^9, 3.760270354444371*^9}, {3.760270385212697*^9, 
   3.760270542139996*^9}, 3.7602705785866766`*^9, {3.7602706379761343`*^9, 
   3.7602706973500023`*^9}, {3.7602707323551064`*^9, 3.760270932105714*^9}, {
   3.7602709713428016`*^9, 3.7602709840863733`*^9}, {3.7602712575862966`*^9, 
   3.7602712642162466`*^9}, {3.760271672154962*^9, 3.7602718378793945`*^9}, {
   3.7603062396612453`*^9, 3.760306239820317*^9}, {3.7603071546272655`*^9, 
   3.760307172377515*^9}, {3.7603072100472794`*^9, 3.7603073146567583`*^9}, {
   3.760307412900114*^9, 3.760307471157817*^9}, {3.7603075680128803`*^9, 
   3.7603075811871758`*^9}, {3.760307803971773*^9, 3.760307849069579*^9}, {
   3.76030799940704*^9, 3.760308052026955*^9}, {3.760308085360051*^9, 
   3.760308096167858*^9}, {3.760308239490907*^9, 3.760308240127483*^9}, {
   3.7603082713554845`*^9, 3.7603082844197006`*^9}, {3.7603087684238214`*^9, 
   3.7603087719283414`*^9}, {3.7603088138180275`*^9, 
   3.7603088332703342`*^9}, {3.7603088635508146`*^9, 3.760308867672061*^9}},
 CellLabel->
  "In[451]:=",ExpressionUUID->"c7900adf-ad31-481f-b8ce-04f9f977f6fc"]
}, Open  ]]
}, Open  ]]
},
NotebookAutoSave->True,
WindowSize->{1304, 1993},
WindowMargins->{{103, Automatic}, {-31, Automatic}},
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 293, 4, 98, "Title",ExpressionUUID->"7c9512d1-d4da-48ef-8c98-e1e558668319"],
Cell[876, 28, 466, 8, 71, "Subsubsection",ExpressionUUID->"c5f43dab-9ff9-46fe-94b3-424a9b387d4a"],
Cell[CellGroupData[{
Cell[1367, 40, 190, 3, 37, "Subsubsection",ExpressionUUID->"7d92b0c1-39d7-4efa-b9b8-1a3a648261d3"],
Cell[1560, 45, 1971, 46, 157, "Input",ExpressionUUID->"cc37747a-5654-4df7-81a7-af9a51ecb48c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3568, 96, 503, 9, 45, "Subsubsection",ExpressionUUID->"5c6f0d37-d563-4274-a3f3-95c1b0e0cb4a"],
Cell[4074, 107, 324, 8, 30, "Input",ExpressionUUID->"ff278916-81ad-471b-871f-246d15c8572c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4435, 120, 196, 3, 45, "Subsubsection",ExpressionUUID->"bdeb9518-088d-4669-b0c1-42a43a04497b"],
Cell[4634, 125, 1725, 47, 136, "Input",ExpressionUUID->"6ff66e00-9805-4b6c-8710-438ba81571cb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6396, 177, 465, 8, 71, "Subsubsection",ExpressionUUID->"7324db92-94fa-47e5-ac34-ed1fe53bca4d"],
Cell[6864, 187, 350, 7, 30, "Input",ExpressionUUID->"d5c893d6-f172-4cf8-93c7-f8f192600e00"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7251, 199, 179, 3, 45, "Subsubsection",ExpressionUUID->"8cf1ffbc-ed33-41f0-8d18-fc82f0eae59a"],
Cell[7433, 204, 782, 17, 94, "Input",ExpressionUUID->"1700c543-6b5e-4c87-ac53-9ac6b638b0ec"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8252, 226, 313, 6, 45, "Subsubsection",ExpressionUUID->"46625db9-c2ea-418a-9215-a9585f63c1aa"],
Cell[8568, 234, 645, 13, 73, "Input",ExpressionUUID->"860b009e-c718-44c8-ae98-522418d7a392"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9250, 252, 245, 7, 71, "Subsubsection",ExpressionUUID->"e40af1a9-53fd-44ba-ac67-95f0094214cd"],
Cell[9498, 261, 4343, 104, 493, "Input",ExpressionUUID->"0d7a10f3-11a6-47fc-9991-1ffbf9aac875"],
Cell[13844, 367, 8233, 173, 724, "Input",ExpressionUUID->"e386794b-c999-4913-a56c-28737d515a48"],
Cell[22080, 542, 17109, 408, 1568, "Input",ExpressionUUID->"6575f0e2-e463-44b0-933f-329ce8eb2864"],
Cell[39192, 952, 3320, 86, 409, "Input",ExpressionUUID->"52dd57fd-f896-4e61-9055-8a2590a40650"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42549, 1043, 268, 6, 44, "Subsubsection",ExpressionUUID->"fad85750-c3e3-40a2-8dce-6410f9d67c60"],
Cell[42820, 1051, 13593, 324, 979, "Input",ExpressionUUID->"c7900adf-ad31-481f-b8ce-04f9f977f6fc"]
}, Open  ]]
}, Open  ]]
}
]
*)

